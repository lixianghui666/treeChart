(()=>{"use strict";var t={701:(t,e,r)=>{r.r(e)},118:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.offset=e.defaultLineConfig=e.defaultCircleConfig=e.defaultRectConfig=e.globalConfig=void 0,e.globalConfig={graphEditLineColor:"#2e9dfe",graphEditLineWidth:.8,graphEditConnerRadius:5,graphEditConnerFillStyle:"#ffffff",graphStrokeStyle:"#000000",graphStrokeWidth:2,graphStrokeDashOffset:5,graphTextFillStyle:"#444444",graphFillStyle:"#ea5355",graphTextFontSize:12,graphTextFontWeight:400,graphTextFontFamily:"Arial",graphTextMaxWidth:120,defaultScaleValue:1},e.defaultRectConfig={strokeStyle:e.globalConfig.graphStrokeStyle,textFillStyle:e.globalConfig.graphTextFillStyle,fillStyle:e.globalConfig.graphFillStyle,strokeWidth:e.globalConfig.graphStrokeWidth,strokeDashOffset:e.globalConfig.graphStrokeDashOffset,width:120,h:36},e.defaultCircleConfig={strokeStyle:e.globalConfig.graphStrokeStyle,textFillStyle:e.globalConfig.graphTextFillStyle,fillStyle:"#ffffff",strokeWidth:e.globalConfig.graphStrokeWidth},e.defaultLineConfig={strokeStyle:e.globalConfig.graphStrokeStyle,strokeWidth:e.globalConfig.graphStrokeWidth},e.offset={x:0,y:0}},820:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GraphType=e.DrawMode=e.GraphDrawStyle=e.StrokeBorderType=e.RectState=e.EventType=e.ParallerVerticalType=e.ParallelHorizationType=void 0,function(t){t[t.TOP=0]="TOP",t[t.CENTER=1]="CENTER",t[t.BOTTOM=2]="BOTTOM"}(e.ParallelHorizationType||(e.ParallelHorizationType={})),function(t){t[t.LEFT=0]="LEFT",t[t.CENTER=1]="CENTER",t[t.RIGHT=2]="RIGHT"}(e.ParallerVerticalType||(e.ParallerVerticalType={})),function(t){t[t.CONTEXTMENU=0]="CONTEXTMENU",t[t.MOUSEDOWN=1]="MOUSEDOWN",t[t.MOUSEMOVE=2]="MOUSEMOVE",t[t.MOUSEUP=3]="MOUSEUP"}(e.EventType||(e.EventType={})),function(t){t[t.DEFAULT=0]="DEFAULT",t[t.EDIT=1]="EDIT"}(e.RectState||(e.RectState={})),function(t){t[t.DASHED=0]="DASHED",t[t.SOLID=1]="SOLID"}(e.StrokeBorderType||(e.StrokeBorderType={})),function(t){t[t.STROKE=0]="STROKE",t[t.FILL=1]="FILL",t[t.STROKEANDFILL=2]="STROKEANDFILL"}(e.GraphDrawStyle||(e.GraphDrawStyle={})),function(t){t[t.SELECT=0]="SELECT",t[t.DRAG=1]="DRAG"}(e.DrawMode||(e.DrawMode={})),function(t){t[t.RECT=0]="RECT",t[t.LINE=1]="LINE",t[t.CIRCLE=2]="CIRCLE",t[t.TEXT=3]="TEXT"}(e.GraphType||(e.GraphType={}))},503:function(t,e,r){var o,l=this&&this.__extends||(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},o(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Text=e.Line=e.Circle=e.Rect=e.Graph=void 0;var a=r(976),i=r(118),n=r(820),d=function(){function t(){this.scale=1,this.children=[]}return t.prototype.draw=function(){},t}();e.Graph=d;var c=function(t){function e(e){var r=t.call(this)||this;r.text="",r.textFillStyle=i.defaultRectConfig.textFillStyle,r.type=n.GraphType.RECT;var o=e.x,l=e.y,a=e.x1,d=e.y1,c=e.r,f=e.ctx,s=e.cvs,y=e.strokeWidth,h=void 0===y?i.defaultRectConfig.strokeWidth:y,S=e.drawStyle,g=void 0===S?n.GraphDrawStyle.FILL:S,u=e.strokeBorderType,p=void 0===u?n.StrokeBorderType.SOLID:u,x=e.scale,T=void 0===x?i.globalConfig.defaultScaleValue:x,v=e.strokeStyle,w=void 0===v?i.defaultRectConfig.strokeStyle:v,C=e.fillStyle,E=void 0===C?i.defaultRectConfig.fillStyle:C,k=e.state,D=void 0===k?n.RectState.DEFAULT:k,L=e.children,b=void 0===L?[]:L;return r.x=o,r.y=l,r.x1=a,r.y1=d,r.r=c*T,r.ctx=f,r.cvs=s,r.drawStyle=g,r.strokeBorderType=p,r.scale=T,r.strokeStyle=w,r.fillStyle=E,r.strokeWidth=h,r.state=D,r.children=b,r}return l(e,t),e.prototype.draw=function(){var t=this,e=t.x,r=t.y,o=t.x1,l=t.y1,d=t.r,c=t.fillStyle,s=t.text,h=t.ctx,S=t.cvs,g=t.strokeBorderType,u=t.strokeStyle,p=t.strokeWidth,x=t.drawStyle,T=t.scale,v=t.state;e+=i.offset.x,o+=i.offset.x,r+=i.offset.y,l+=i.offset.y,h.beginPath(),h.fillStyle=c,h.strokeStyle=u,h.lineWidth=p;var w=0;switch(g===n.StrokeBorderType.DASHED&&(w=i.globalConfig.graphStrokeDashOffset),h.lineDashOffset=w,h.setLineDash([w]),v===n.RectState.DEFAULT&&(h.shadowColor="rgba(0,0,0,.05)",h.shadowBlur=10,h.shadowOffsetX=h.shadowOffsetY=10),h.moveTo(e+d,r),h.arc(o-d,r+d,d,(0,a.degToArc)(270),(0,a.degToArc)(360)),h.arc(o-d,l-d,d,(0,a.degToArc)(0),(0,a.degToArc)(90)),h.arc(e+d,l-d,d,(0,a.degToArc)(90),(0,a.degToArc)(180)),h.arc(e+d,r+d,d,(0,a.degToArc)(180),(0,a.degToArc)(270)),h.closePath(),x){case n.GraphDrawStyle.FILL:h.fill();break;case n.GraphDrawStyle.STROKEANDFILL:h.fill(),h.stroke();break;default:h.stroke()}new y({text:s,x:e+(o-e)/2,y:r+(l-r)/2,maxWidth:o-e-20,ctx:h,cvs:S,scale:1,fontSize:i.globalConfig.graphTextFontSize*T}).draw(),h.closePath(),v===n.RectState.EDIT&&[[e,r],[e,l],[o,r],[o,l]].map((function(t){var e=t[0],r=t[1];return new f({x:e,y:r,r:i.globalConfig.graphEditConnerRadius,strokeStyle:i.globalConfig.graphEditLineColor,strokeWidth:i.globalConfig.graphEditLineWidth,fillStyle:i.globalConfig.graphEditConnerFillStyle,cvs:S,ctx:h,drawStyle:n.GraphDrawStyle.STROKEANDFILL}).draw()}))},e}(d);e.Rect=c;var f=function(t){function e(e){var r=t.call(this)||this;r.type=n.GraphType.CIRCLE;var o=e.ctx,l=e.cvs,a=e.x,d=e.y,c=e.r,f=e.drawStyle,s=void 0===f?n.GraphDrawStyle.STROKE:f,y=e.scale,h=void 0===y?1:y,S=e.strokeStyle,g=void 0===S?i.defaultCircleConfig.strokeStyle:S,u=e.fillStyle,p=void 0===u?i.defaultCircleConfig.fillStyle:u,x=e.strokeBorderType,T=void 0===x?n.StrokeBorderType.SOLID:x,v=e.strokeWidth,w=void 0===v?i.defaultCircleConfig.strokeWidth:v;return r.scale=h,r.ctx=o,r.cvs=l,r.x=a-c,r.y=d-c,r.r=c*h,r.drawStyle=s,r.strokeStyle=g,r.fillStyle=p,r.strokeBorderType=T,r.strokeWidth=w,r.x1=a+c,r.y1=d+c,r}return l(e,t),e.prototype.draw=function(){var t=this,e=t.ctx,r=t.x,o=t.y,l=t.r,a=t.fillStyle,i=t.drawStyle,d=t.strokeStyle,c=t.strokeWidth;switch(e.beginPath(),e.fillStyle=a,e.lineWidth=c,e.strokeStyle=d,e.lineDashOffset=0,e.setLineDash([0]),e.arc(r+l,o+l,l,0,360),i){case n.GraphDrawStyle.FILL:e.fill();break;case n.GraphDrawStyle.STROKEANDFILL:e.fill(),e.stroke();break;default:e.stroke()}e.closePath()},e}(d);e.Circle=f;var s=function(t){function e(e){var r=t.call(this)||this;r.type=n.GraphType.LINE;var o=e.x,l=e.y,a=e.x1,d=e.y1,c=e.strokeWidth,f=void 0===c?i.defaultLineConfig.strokeWidth:c,s=e.strokeStyle,y=void 0===s?i.defaultLineConfig.strokeStyle:s,h=e.ctx,S=e.cvs,g=e.scale;r.scale=g;Math.abs(o-a);return r.x=o,r.y=l,r.x1=a,r.y1=d,r.strokeStyle=y,r.strokeWidth=f,r.ctx=h,r.cvs=S,r}return l(e,t),e.prototype.draw=function(){var t=this,e=t.ctx,r=t.x,o=t.y,l=t.x1,a=t.y1,i=t.strokeStyle,n=t.strokeWidth;e.beginPath(),e.lineWidth=n,e.strokeStyle=i,e.moveTo(r,o),e.lineTo(l,a),e.stroke(),e.closePath()},e}(d);e.Line=s;var y=function(t){function e(e){var r=t.call(this)||this;r.type=n.GraphType.TEXT,r.fh=0;var o=e.x,l=e.y,a=e.text,d=void 0===a?"":a,c=e.fillStyle,f=void 0===c?i.globalConfig.graphTextFillStyle:c,s=e.strokeStyle,y=void 0===s?i.globalConfig.graphStrokeStyle:s,h=e.fontSize,S=void 0===h?i.globalConfig.graphTextFontSize:h,g=e.fontFamily,u=void 0===g?i.globalConfig.graphTextFontFamily:g,p=e.fontWeight,x=void 0===p?i.globalConfig.graphTextFontWeight:p,T=e.textAlign,v=void 0===T?"center":T,w=e.textBaseline,C=void 0===w?"middle":w,E=e.ctx,k=e.maxWidth,D=void 0===k?i.globalConfig.graphTextMaxWidth:k,L=e.drawStyle,b=void 0===L?n.GraphDrawStyle.FILL:L,R=e.scale,O=void 0===R?1:R;r.text=d,r.fillStyle=f,r.strokeStyle=y,r.fontSize=S*O,r.fontFamily=u,r.fontWeight=x,r.textAlign=v,r.textBaseline=C,r.ctx=E,r.maxWidth=D,r.drawStyle=b,r.scale=O,E.font="".concat(x," ").concat(S,"px ").concat(u);var M=E.measureText(d),F=M.width,m=M.fontBoundingBoxAscent;return r.padding=5,r.fh=m,r.y=l-m-5,r.x=o-5,r.x1=o+F+5,r.y1=l+5,r}return l(e,t),e.prototype.draw=function(){var t=this,e=t.ctx,r=t.x,o=t.y,l=t.fh,a=t.text,i=t.padding,d=(t.fontSize,t.fontFamily,t.fontWeight,t.fillStyle),c=t.maxWidth,f=(t.textAlign,t.textBaseline,t.drawStyle);e.fillStyle=d,f===n.GraphDrawStyle.FILL?e.fillText(a,r+i,o+l+i,c):e.strokeText(a,r+i,o+l+i,c)},e}(d);e.Text=y},976:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.enlargePx=e.scalePx=e.degToArc=void 0;e.degToArc=function(t){return t/180*Math.PI};e.scalePx=function(t){return t*$(window).width()/1440};e.enlargePx=function(t){return 1440*t/$(window).width()}}},e={};function r(o){var l=e[o];if(void 0!==l)return l.exports;var a=e[o]={exports:{}};return t[o].call(a.exports,a,a.exports,r),a.exports}r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};(()=>{r(701);var t,e,o=r(820),l=r(503),a=r(118),i=$(".treeChart"),n=i[0].getContext("2d"),d=$(window).width(),c=$(window).height(),f=[new l.Rect({x:400,y:200,x1:540,y1:236,ctx:n,cvs:i,scale:1,r:0,strokeWidth:2,drawStyle:o.GraphDrawStyle.STROKE}),new l.Circle({x:500,y:300,r:50,cvs:i,ctx:n}),new l.Text({x:100,y:100,text:"测试，\n        哈哈",cvs:i,ctx:n})],s=0,y=0,h=0,S=0,g=0,u=0,p=null;function x(){var r=i[0],l=r.width,a=r.height;n.clearRect(0,0,l,a),f.forEach((function(t){return t.draw()})),p&&p.draw(),e&&![o.DrawMode.DRAG].includes(t)&&e.draw()}function T(t,e,r){var o=t.x,l=t.y,a=t.x1,i=t.y1,n=Math.min(o,a),d=Math.max(o,a),c=Math.min(l,i),f=Math.max(l,i);return e>=n&&e<=d&&r>=c&&r<=f}function v(t,r){e=null;var i=Math.abs(s-h),n=Math.abs(y-S),d=f.filter((function(t){var e=t.x,r=t.y,o=t.x1,l=t.y1,a=Math.abs(o-e),d=Math.abs(r-l),c=Math.min(s,h,e,o),f=Math.max(s,h,e,o),g=Math.min(y,S,r,l),u=Math.max(y,S,r,l);return f-c<=i+a&&u-g<=n+d})),c=d.length;if(0!=c){for(var g=d[0],u=g.x,p=g.x1,x=g.y,T=g.y1,v=1;v<c;++v){var w=d[v],C=w.x,E=w.x1,k=w.y,D=w.y1;u=Math.min(u,C),p=Math.max(p,E),x=Math.min(x,k),T=Math.max(T,D)}u===p||x==T||(e=new l.Rect({x:u,x1:p,y:x,y1:T,cvs:t,ctx:r,r:0,state:o.RectState.EDIT,strokeStyle:a.globalConfig.graphEditLineColor,strokeWidth:a.globalConfig.graphEditLineWidth,drawStyle:o.GraphDrawStyle.STROKE,children:d}))}}$(window).resize((function(){d=$(window).width(),c=$(window).height(),i[0].style.width=d+"px",i[0].style.height=c+"px",i[0].width=d*devicePixelRatio,i[0].height=c*devicePixelRatio,n.scale(devicePixelRatio,devicePixelRatio),x()})),$(window).resize(),$(document).mousedown((function(r){s=g=r.clientX,y=u=r.clientY,t=o.DrawMode.SELECT,e&&!T(e,s,y)&&(e=null),e||v(i,n),e&&T(e,s,y)&&($("body").addClass("cursor-drag"),t=o.DrawMode.DRAG)})),$(document).mousemove((function(r){switch(h=r.clientX,S=r.clientY,t){case o.DrawMode.SELECT:!function(t,e,r,i,n,d){p=new l.Rect({x:t,y:e,x1:r,y1:i,r:0,ctx:d,cvs:n,drawStyle:o.GraphDrawStyle.STROKEANDFILL,strokeStyle:a.globalConfig.graphEditLineColor,fillStyle:"rgba(47,157,254,.05)",strokeWidth:.3,scale:1})}(s,y,h,S,i,n);case o.DrawMode.DRAG:!function(t,r,o,l){if(!e)return;var a=o-t,i=l-r;e.x+=a,e.y+=i,e.x1+=a,e.y1+=i,e.children.forEach((function(t){t.x+=a,t.x1+=a,t.y+=i,t.y1+=i})),x()}(g,u,h,S)}if(e&&![o.DrawMode.DRAG].includes(t)&&e.type===o.GraphType.RECT){$("body").attr("class","");var d=e.x,c=e.y,f=e.x1,T=e.y1,v=a.globalConfig.graphEditConnerRadius;[[d,c],[f,c],[f,T],[d,T]].some((function(t,e){var r=t[0],o=t[1];return h>=r-v&&h<=r+v&&S>=o-v&&S<=o+v&&($("body").addClass(["cursor-nw","cursor-ne","cursor-se","cursor-sw"][e]),!0)}))||[h>d+v&&h<f-v&&S>c-v&&S<c+v,S>c+v&&S<T-v&&h>f-v&&h<f+v,h>d+v&&h<f-v&&S>T-v&&S<T+v,S>c+v&&S<T-v&&h>d-v&&h<d+v].some((function(t,e){return t&&$("body").addClass(["cursor-n","cursor-e","cursor-s","cursor-w"][e])}))}g=h,u=S,x()})),$(document).mouseup((function(){if(t===o.DrawMode.SELECT)v(i,n);t=null,p=null,x()})),$(document).on("mousewheel",(function(t){})),$(document).on("contextmenu",(function(t){return t.stopPropagation(),!1})),x()})()})();